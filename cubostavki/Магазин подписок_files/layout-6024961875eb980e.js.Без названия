(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{8416:function(e,t,s){Promise.resolve().then(s.bind(s,2348))},1024:function(e,t,s){"use strict";s.d(t,{Z:function(){return o}});var r=s(8472),n=s(1103),a=s(1191);class o{static isoStringToDate(e){return e?new Date(e):null}static createAxiosInstance(e){let t=r.Z.create({baseURL:this.BASE_URL+e});return t.interceptors.request.use(this.requestInterceptor),t.interceptors.response.use(e=>e,e=>{if(401===e.response.status){let s=e.config;if(!s._retried)return console.error("Catched 401 response, retrying..."),s._retried=!0,a.Z.refreshTokens().then(e=>(console.log("Refreshed tokens"),s.headers.Authorization="Bearer "+e.accessToken,t(s))).catch(t=>(console.error("Failed to refresh tokens: "+t),Promise.reject(e)))}return Promise.reject(e)}),t}static async requestInterceptor(e){let t=n.vN.getState().accessToken;return t&&(e.headers.Authorization="Bearer ".concat(t)),e}}o.BASE_URL="https://portal.api.cuboserver.net"},2429:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});class r{static getCachedPromise(e,t){if(this.promises[e])return this.promises[e];let s=t().then(t=>(this.promises[e]=null,t)).catch(t=>{throw this.promises[e]=null,t});return this.promises[e]=s,s}}r.promises={}},1191:function(e,t,s){"use strict";s.d(t,{Z:function(){return o}});var r=s(8472),n=s(1103),a=s(2429);class o{static login(e,t){return new Promise((s,r)=>{this.axios.post("login",{username:e,password:t}).then(e=>{console.log(e.data),s({accessToken:e.data.accessToken,refreshToken:e.data.refreshToken})}).catch(e=>{console.error(e.response.data.detail),r(e.response.data.detail)})})}static refreshTokens(){return a.Z.getCachedPromise("refreshTokens",()=>new Promise((e,t)=>{this.axios.post("refresh",{refreshToken:n.st.getState().refreshToken}).then(t=>{console.log(t.data),e({accessToken:t.data.accessToken,refreshToken:t.data.refreshToken})}).catch(e=>{console.error(e.response.data.detail),t(e.response.data.detail)})}))}static logout(){return new Promise((e,t)=>{this.axios.post("logout",{refreshToken:n.st.getState().refreshToken}).then(()=>{e()}).catch(e=>{console.error(e.response.data.detail),t(e.response.data.detail)})})}static retrieveRegistrationInfo(e){return new Promise((t,s)=>{this.axios.post("retrieve_registration_info",{token:e}).then(e=>{console.log(e.data),t(e.data)}).catch(e=>{console.error(e.response.data.detail),s(e.response.data.detail)})})}static register(e,t,s,r){return new Promise((n,a)=>{this.axios.post("register",{token:e,password:t,email:s,emailToken:r}).then(()=>{n()}).catch(e=>{console.error(e.response.data.detail),a(e.response.data.detail)})})}static sendRegistrationMail(e,t){return new Promise((s,r)=>{this.axios.post("send_registration_mail",{token:e,email:t}).then(()=>{s()}).catch(e=>{console.error(e.response.data.detail),r(e.response.data.detail)})})}static sendPasswordRecoverMail(e,t){return new Promise((s,r)=>{this.axios.post("password_recover/send_mail",{username:e,email:t}).then(()=>{s()}).catch(e=>{console.error(e.response.data.detail),r(e.response.data.detail)})})}static checkPasswordRecoverToken(e){return new Promise((t,s)=>{this.axios.post("password_recover/check_token",{token:e}).then(e=>{console.log(e.data),t(e.data)}).catch(e=>{console.error(e.response.data.detail),s(e.response.data.detail)})})}static resetPassword(e,t){return new Promise((s,r)=>{this.axios.post("password_recover/reset",{token:e,password:t}).then(()=>{s()}).catch(e=>{console.error(e.response.data.detail),r(e.response.data.detail)})})}}o.axios=r.Z.create({baseURL:"https://portal.api.cuboserver.net/auth/"})},740:function(e,t,s){"use strict";var r,n;s.d(t,{Q:function(){return r},l:function(){return a}}),(n=r||(r={})).TIER_1="TIER_1",n.TIER_2="TIER_2",n.TIER_3="TIER_3",n.TIER_X="TIER_X";class a{static getBadgeImagePath(e){switch(e){case"TIER_1":return"/shop/tier1.png";case"TIER_2":return"/shop/tier2.png";case"TIER_3":return"/shop/tier3.png";case"TIER_X":return"/shop/tierX.png"}}static getDisplayName(e){switch(e){case"TIER_1":return"Tier I";case"TIER_2":return"Tier II";case"TIER_3":return"Tier III";case"TIER_X":return"Tier X"}}}},5048:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(1024),n=s(740);class a{static obtainProfile(){return new Promise((e,t)=>{this.axios.get("whoami").then(t=>{let s=t.data;t.data.subscription&&(s.subscription.tier=n.Q[t.data.subscription.tier]),console.log(s),e(s)}).catch(e=>{console.error(e),t(e)})})}static changePassword(e,t){return new Promise((s,r)=>{this.axios.post("change_password",{oldPassword:e,newPassword:t}).then(()=>{s()}).catch(e=>{console.error(e.response.data.detail),r(e.response.data.detail)})})}static sendEmailChangeToken(e){return new Promise((t,s)=>{this.axios.post("change_email/send_token",{email:e}).then(()=>{t()}).catch(e=>{console.error(e.response.data.detail),s(e.response.data.detail)})})}static confirmEmailChange(e,t){return new Promise((s,r)=>{this.axios.post("change_email/confirm",{email:e,token:t}).then(()=>{s()}).catch(e=>{console.error(e.response.data.detail),r(e.response.data.detail)})})}}a.axios=r.Z.createAxiosInstance("/profile/")},2348:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return m}});var r=s(7437),n=s(4562),a=s.n(n),o=s(6598),i=s.n(o),c=s(1532),l=s.n(c);s(3054);var u=s(1103),h=s(2265),d=s(5048),p=s(1191);function f(e){let{setProfile:t,clearProfile:s,setProfileFetched:n,profile:a}=(0,u.Oz)(),{refreshToken:o,setRefreshToken:i,clearRefreshToken:c}=(0,u.st)(),{accessToken:l,setAccessToken:f}=(0,u.vN)();return(0,h.useEffect)(()=>{if(n(!1),console.log(l),console.log(o),null===l){o?p.Z.refreshTokens().then(e=>{i(e.refreshToken),f(e.accessToken)}).catch(()=>{c(),n(!0)}):n(!0);return}d.Z.obtainProfile().then(e=>{t(e),n(!0)}).catch(()=>{n(!0),s()})},[l,o]),(0,r.jsx)(r.Fragment,{children:e.children})}var _=s(8726);function m(e){let{children:t}=e,{title:s}=(0,u.Wb)();return(0,r.jsx)(f,{children:(0,r.jsxs)("html",{lang:"en",className:"".concat(i().variable," ").concat(a().variable," ").concat(l().variable),children:[(0,r.jsx)("head",{children:(0,r.jsx)("title",{children:s})}),(0,r.jsxs)("body",{className:"bg-zinc-950 font-text",children:[(0,r.jsx)(_.x7,{toastOptions:{duration:4e3},position:"bottom-right"}),t]})]})})}},1103:function(e,t,s){"use strict";s.d(t,{Oz:function(){return a},Wb:function(){return l},oY:function(){return c},st:function(){return o},vN:function(){return i}});var r=s(903),n=s(9291);let a=(0,r.U)(e=>({profile:null,profileFetched:!1,setProfile:t=>e({profile:t}),setProfileFetched:t=>e({profileFetched:t}),clearProfile:()=>e({profile:null})})),o=(0,r.U)((0,n.tJ)(e=>({refreshToken:null,setRefreshToken:t=>e({refreshToken:t}),clearRefreshToken:()=>e({refreshToken:null})}),{name:"cuboserver-credentials-store"})),i=(0,r.U)(e=>({accessToken:null,setAccessToken:t=>e({accessToken:t}),clearAccessToken:()=>e({accessToken:null})})),c=(0,r.U)(e=>({billingProfile:null,setBillingProfile:t=>e({billingProfile:t}),subscriptionChangePreview:null,setSubscriptionChangePreview:t=>e({subscriptionChangePreview:t}),tiersInfo:null,setTiersInfo:t=>e({tiersInfo:t}),clearCache:()=>e({billingProfile:null,subscriptionChangePreview:null,tiersInfo:null})})),l=(0,r.U)(e=>({title:"Cuboserver",setTitle:t=>e({title:t})}))},3054:function(){},4562:function(e){e.exports={style:{fontFamily:"'__Inter_05e69f', '__Inter_Fallback_05e69f'",fontStyle:"normal"},className:"__className_05e69f",variable:"__variable_05e69f"}},6598:function(e){e.exports={style:{fontFamily:"'__Manrope_434495', '__Manrope_Fallback_434495'",fontStyle:"normal"},className:"__className_434495",variable:"__variable_434495"}},1532:function(e){e.exports={style:{fontFamily:"'__minecraftFont_ec4a0a', '__minecraftFont_Fallback_ec4a0a'"},className:"__className_ec4a0a",variable:"__variable_ec4a0a"}}},function(e){e.O(0,[655,837,726,971,23,744],function(){return e(e.s=8416)}),_N_E=e.O()}]);